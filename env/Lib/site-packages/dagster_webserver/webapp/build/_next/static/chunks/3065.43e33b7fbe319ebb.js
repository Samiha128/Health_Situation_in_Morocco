"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3065],{63065:function(e,n,t){t.d(n,{e:function(){return T}});var r=t(73235),o=t(52322),i=t(40794),s=t(89130),l=t(14934),a=t(79106),c=t(39013),d=t(37483),u=t(74159),p=t(45774),h=t(2784),x=t(78491),j=t(16336),m=t(44900),g=t(4378),b=t(43250),f=t(35002),y=t(43212),v=t(88510),w=t(22921),E=t(17008),N=t(98956),L=t(50646),C=t(63485),J=t(83738),R=t(22563);let k=e=>{let{repos:n}=e,t=(0,h.useRef)(null),r=(0,h.useMemo)(()=>n.map(e=>{let{repoAddress:n}=e;return(0,R.Uz)(n)}),[n]),{expandedKeys:i,onToggle:s,onToggleAll:l}=(0,L.N)(w.y,r),a=(0,h.useMemo)(()=>{let e=[];return n.forEach(n=>{let{repoAddress:t,jobs:r}=n;e.push({type:"header",repoAddress:t,jobCount:r.length});let o=(0,R.Uz)(t);i.includes(o)&&r.forEach(n=>{let{isJob:r,name:o}=n;e.push({type:"job",repoAddress:t,isJob:r,name:o})})}),e},[n,i]),c=(0,N.w)(n.map(e=>{let{repoAddress:n}=e;return n.name})),d=(0,v.MG)({count:a.length,getScrollElement:()=>t.current,estimateSize:e=>{let n=a[e];return(null==n?void 0:n.type)==="header"?E.lo:64},overscan:10}),u=d.getTotalSize(),p=d.getVirtualItems();return(0,o.jsx)("div",{style:{overflow:"hidden"},children:(0,o.jsxs)(E.W2,{ref:t,children:[(0,o.jsx)(C.I,{}),(0,o.jsx)(E.Nh,{$totalHeight:u,children:p.map(e=>{let{index:n,key:t,size:r,start:d}=e,u=a[n];return"header"===u.type?(0,o.jsx)(J.vG,{repoAddress:u.repoAddress,height:r,start:d,onToggle:s,onToggleAll:l,expanded:i.includes((0,R.Uz)(u.repoAddress)),showLocation:c.has(u.repoAddress.name),rightElement:(0,o.jsx)(f.u,{content:1===u.jobCount?"1 job":"".concat(u.jobCount," jobs"),placement:"top",children:(0,o.jsx)(y.V,{children:u.jobCount})})},t):(0,o.jsx)(C.b,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:r,start:d},t)})})]})})};var _=t(907),P=t(49455),S=t(34219),q=t(73658),O=t(100),I=t(65822);function A(){let e=(0,r._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return A=function(){return e},e}let T=()=>{let{allRepos:e,visibleRepos:n,loading:t,data:r}=(0,h.useContext)(O.C5),[s,x]=(0,g.q)({queryKey:"search",defaults:{search:""}}),m=e.length,f=(0,i.a)(F,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:y,loading:v}=f,w=(0,j.C4)(f,j.dT),E=(0,h.useMemo)(()=>{let e=Object.values(r).filter(e=>"WorkspaceLocationEntry"===e.__typename),t=null==y?void 0:y.workspaceOrError,o=(null==t?void 0:t.__typename)==="Workspace"?t.locationEntries:e,i=(0,P.S)(n);return $(o).filter(e=>{let{repoAddress:n}=e;return i.has((0,R.Uz)(n))})},[r,y,n]),N=!y&&t;(0,S.j$)("OverviewJobs",!N);let L=s.trim().toLocaleLowerCase(),C=L.length>0,J=(0,h.useMemo)(()=>{let e=L.toLocaleLowerCase();return E.map(n=>{let{repoAddress:t,jobs:r}=n;return{repoAddress:t,jobs:r.filter(n=>{let{name:t}=n;return t.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{jobs:n}=e;return n.length>0})},[E,L]),_=v&&!y;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(l.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},children:[(0,o.jsxs)(l.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[m>1?(0,o.jsx)(b.C,{}):null,(0,o.jsx)(u.oi,{icon:"search",value:s,rightElement:_?(0,o.jsx)(q.W,{tooltipContent:"Loading jobs…"}):void 0,onChange:e=>x(e.target.value),placeholder:"Filter by job name…",style:{width:"340px"}})]}),(0,o.jsx)(j.xi,{refreshState:w})]}),N&&!m?(0,o.jsx)(l.x,{padding:64,children:(0,o.jsx)(p.f,{label:"Loading jobs…"})}):(()=>{if(N)return(0,o.jsx)(l.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,o.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,o.jsx)(a.$,{purpose:"body-text"}),(0,o.jsx)("div",{style:{color:c.$()},children:"Loading jobs…"})]})});let t=e.length>n.length;return J.length?(0,o.jsx)(k,{repos:J}):C?(0,o.jsx)(l.x,{padding:{top:20},children:(0,o.jsx)(d.t,{icon:"search",title:"No matching jobs",description:t?(0,o.jsxs)("div",{children:["No jobs matching ",(0,o.jsx)("strong",{children:s})," were found in the selected code locations"]}):(0,o.jsxs)("div",{children:["No jobs matching ",(0,o.jsx)("strong",{children:s})," were found in your definitions"]})})}):(0,o.jsx)(l.x,{padding:{top:20},children:(0,o.jsx)(d.t,{icon:"search",title:"No jobs",description:t?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})})()]})},$=e=>{let n=e.map(e=>e.locationOrLoadError),t=[];for(let e of n)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let n of e.repositories){let{name:r,pipelines:o}=n,i=(0,I.kQ)(r,e.name),s=o.filter(e=>{let{name:n}=e;return!(0,m.pv)(n)}).map(e=>({isJob:e.isJob,name:e.name}));s.length>0&&t.push({repoAddress:i,jobs:s})}return(0,_.S)(t)},F=(0,s.Ps)(A(),x.B)},63485:function(e,n,t){t.d(n,{I:function(){return W},b:function(){return M}});var r=t(73235),o=t(52322),i=t(3842),s=t(89130),l=t(53664),a=t(14934),c=t(2784),d=t(47933),u=t(35505),p=t(83738),h=t(100),x=t(10539),j=t(16336),m=t(60603),g=t(79106),b=t(55010),f=t(35002),y=t(38491),v=t(92917),w=t(36803),E=t(32177),N=t(51701),L=t(88257),C=t(34219),J=t(83846),R=t(42519),k=t(43);function _(){let e=(0,r._)(["\n  query RunReExecutionQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        pipelineName\n        executionPlan {\n          artifactsPersisted\n          ...ExecutionPlanToGraphFragment\n        }\n      }\n    }\n  }\n  ","\n"]);return _=function(){return e},e}let P=e=>{let{job:n,isAssetJob:t,repoAddress:r}=e,s=n.runs.length?n.runs[0]:null,l={pipelineName:n.name,repositoryName:r.name,repositoryLocationName:r.location},a=(0,E.DO)(n.name),d=(0,R.D)(),{permissions:{canLaunchPipelineReexecution:u,canLaunchPipelineExecution:p},disabledReasons:h}=(0,w.xz)(r.location),[j,N]=(0,i.t)(S),{data:_}=N;(0,C.Hu)(N,"RunReExecutionQuery");let P=(0,c.useCallback)(()=>{(null==s?void 0:s.id)&&j({variables:{runId:s.id}})},[s,j]),q=(null==_?void 0:_.pipelineRunOrError.__typename)==="Run"?null==_?void 0:_.pipelineRunOrError:null,O="loading"===t?(0,o.jsx)(m.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===t?(0,o.jsx)(m.sN,{icon:a.loading?(0,o.jsx)(g.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!p,onClick:e=>a.onClick(l,e)}):(0,o.jsx)(k.U,{icon:"execute",text:"Launch new run",disabled:!p,to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob,path:"/playground"})}),I=(0,o.jsx)(m.sN,{icon:"replay",text:"Re-execute latest run",onClick:()=>q?d(q,L.hmq.ALL_STEPS):void 0,disabled:!u||!q||!(0,J.EP)(q)}),A=(0,o.jsx)(m.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:()=>q?d(q,L.hmq.FROM_FAILURE):void 0,disabled:!u||!q||!(0,J.VM)(q)});return(0,o.jsxs)(o.Fragment,{children:[a.launchpadElement,(0,o.jsx)(b.J,{onOpened:()=>P(),content:(0,o.jsxs)(m.v2,{children:[(0,o.jsx)(k.U,{to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob}),icon:"job",text:"View job"}),(0,o.jsx)(k.U,{to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),p?O:(0,o.jsx)(f.u,{content:h.canLaunchPipelineExecution,display:"block",children:O}),u?I:(0,o.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:I}),u?A:(0,o.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:A})]}),position:"bottom-left",children:(0,o.jsx)(y.zx,{icon:(0,o.jsx)(v.JO,{name:"expand_more"})})})]})},S=(0,s.Ps)(_(),N.$);var q=t(60648),O=t(74283),I=t(84046),A=t(33182),T=t(4219),$=t(69698),F=t(17008);function U(){let e=(0,r._)(["\n  query SingleJobQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      ... on Pipeline {\n        id\n        name\n        isJob\n        isAssetJob\n        description\n        runs(limit: 5) {\n          id\n          ...RunTimeFragment\n        }\n        schedules {\n          id\n          ...ScheduleSwitchFragment\n        }\n        sensors {\n          id\n          ...SensorSwitchFragment\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return U=function(){return e},e}let z="1.5fr 1fr 180px 96px 80px",M=e=>{let{name:n,isJob:t,repoAddress:r,start:s,height:u}=e,[m,g]=(0,i.t)(V,{variables:{selector:(0,h._T)(r,n)}});(0,C.Hu)(g,"SingleJobQuery"),(0,p.v5)(m),(0,j.C4)(g,j.dT);let{data:b}=g,f=(null==b?void 0:b.pipelineOrError.__typename)==="Pipeline"?null==b?void 0:b.pipelineOrError:void 0,{schedules:y,sensors:v}=(0,c.useMemo)(()=>{if(f){let{schedules:e,sensors:n}=f;return{schedules:e,sensors:n}}return{schedules:[],sensors:[]}},[f]),w=(0,c.useMemo)(()=>{if(f){let{runs:e}=f;if(e.length)return[...e]}return[]},[f]);return(0,o.jsx)(F.X2,{$height:u,$start:s,children:(0,o.jsxs)(H,{border:"bottom",children:[(0,o.jsxs)(F.E5,{children:[(0,o.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,o.jsx)(d.rU,{to:(0,x.$U)(r,"/jobs/".concat(n)),children:(0,o.jsx)(l.g,{text:n})})}),(0,o.jsx)(p.HB,{children:(null==f?void 0:f.description)||""})]}),(0,o.jsx)(F.E5,{children:y.length||v.length?(0,o.jsx)(a.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,o.jsx)(Q,{children:(0,o.jsx)(O.I,{schedules:y,sensors:v,repoAddress:r})})}):(0,o.jsx)(p.mq,{queryResult:g})}),(0,o.jsx)(F.E5,{children:w[0]?(0,o.jsx)(q.Z,{run:w[0],showButton:!1,showHover:!0,showSummary:!1,name:n}):(0,o.jsx)(p.mq,{queryResult:g})}),(0,o.jsx)(F.E5,{children:w.length?(0,o.jsx)(a.x,{padding:{top:4},children:(0,o.jsx)(I.JH,{jobName:n,runs:[...w].reverse(),fade:!0})}):(0,o.jsx)(p.mq,{queryResult:g})}),(0,o.jsx)(F.E5,{children:(0,o.jsx)(a.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,o.jsx)(P,{job:{name:n,isJob:t,runs:w},isAssetJob:f?f.isAssetJob:"loading",repoAddress:r})})})]})})},W=()=>(0,o.jsxs)(F.VJ,{templateColumns:z,sticky:!0,children:[(0,o.jsx)(F.qN,{children:"Name"}),(0,o.jsx)(F.qN,{children:"Schedules/sensors"}),(0,o.jsx)(F.qN,{children:"Latest run"}),(0,o.jsx)(F.qN,{children:"Run history"}),(0,o.jsx)(F.qN,{})]}),H=(0,u.ZP)(a.x).withConfig({componentId:"sc-cd82bd61-0"})(["display:grid;grid-template-columns:",";height:100%;"],z),Q=u.ZP.div.withConfig({componentId:"sc-cd82bd61-1"})(["width:100%;> .bp4-popover2-target{width:100%;}"]),V=(0,s.Ps)(U(),A.$X,T.J,$.U)}}]);
//# sourceMappingURL=3065.43e33b7fbe319ebb.js.map